\hypertarget{data__lfmm_8h}{\section{src/\-L\-F\-M\-M/data\-\_\-lfmm.h \-File \-Reference}
\label{data__lfmm_8h}\index{src/\-L\-F\-M\-M/data\-\_\-lfmm.\-h@{src/\-L\-F\-M\-M/data\-\_\-lfmm.\-h}}
}


set of functions to manage data  


{\ttfamily \#include \char`\"{}../matrix/data.\-h\char`\"{}}\*
\subsection*{\-Defines}
\begin{DoxyCompactItemize}
\item 
\hypertarget{data__lfmm_8h_a95cf1ca63ff303311d342d1a53d51f38}{\#define {\bfseries \-S\-E\-P}~\char`\"{} \char`\"{}}\label{data__lfmm_8h_a95cf1ca63ff303311d342d1a53d51f38}

\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{data__lfmm_8h_a8bbd6e5a64e1620477f22a0a694c558d}{zscore\-\_\-calc} (double $\ast$zscore, double $\ast$sum, double $\ast$sum2, int n, int cur)
\item 
void \hyperlink{data__lfmm_8h_a6c3f14b9e0553c9897e12668d587d26c}{update\-\_\-sum} (double $\ast$beta, double $\ast$sum, int n)
\item 
void \hyperlink{data__lfmm_8h_a4ae2e50700eac954ed4399d012363945}{update\-\_\-sum2} (double $\ast$beta, double $\ast$sum2, int n)
\item 
void \hyperlink{data__lfmm_8h_acb4caffd3e20eef5c881bb033cf3bea3}{update\-\_\-deviance} (double $\ast$deviance, int cur, double var, double thrd\-\_\-m)
\item 
void \hyperlink{data__lfmm_8h_a8f98fecf4137be7dd3d970b52195aad1}{update\-\_\-mean} (double $\ast$beta, double $\ast$mean, int n, int cur)
\item 
void \hyperlink{data__lfmm_8h_a88b2f546a5a50f8ffec57ef30d7171ec}{modify\-\_\-\-C} (double $\ast$\-C, int \-N, int n\-D, double $\ast$\-Cpp, int d)
\item 
void \hyperlink{data__lfmm_8h_a6151b34834ddf44142f6598bf837b71f}{write\-\_\-\-D\-I\-C} (char $\ast$file\-\_\-data, double deviance, double \-D\-I\-C)
\item 
void \hyperlink{data__lfmm_8h_abbc018276b8b10c368d908911e6d0616}{write\-\_\-zscore\-\_\-double} (char $\ast$file\-\_\-data, int \-M, double $\ast$zscore)
\item 
double \hyperlink{data__lfmm_8h_a41f76544f978b241d3c896c3a1ecdb19}{var\-\_\-data} (float $\ast$\-R, double $\ast$\-U, double $\ast$\-V, double $\ast$\-C, double $\ast$beta, int \-N, int \-M, int \-K, int \-D, double $\ast$thrd\-\_\-m2, int num\-\_\-thrd)
\item 
void \hyperlink{data__lfmm_8h_a50f7190a1cd7413f1371665d7cebce5b}{inputation} (float $\ast$\-R, double $\ast$\-U, double $\ast$\-V, double $\ast$\-C, double $\ast$beta, int $\ast$\-I, int \-N, int \-M, int \-K, int \-D)
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
set of functions to manage data 

\subsection{\-Function \-Documentation}
\hypertarget{data__lfmm_8h_a50f7190a1cd7413f1371665d7cebce5b}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!inputation@{inputation}}
\index{inputation@{inputation}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{inputation}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf inputation} (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{\-R, }
\item[{double $\ast$}]{\-U, }
\item[{double $\ast$}]{\-V, }
\item[{double $\ast$}]{\-C, }
\item[{double $\ast$}]{beta, }
\item[{int $\ast$}]{\-I, }
\item[{int}]{\-N, }
\item[{int}]{\-M, }
\item[{int}]{\-K, }
\item[{int}]{\-D}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a50f7190a1cd7413f1371665d7cebce5b}
input missing values with \-U'$\ast$\-V+\-C$\ast$beta


\begin{DoxyParams}{\-Parameters}
{\em \-R} & the data matrix (of size \-Nx\-M) \\
\hline
{\em \-U} & the \-U matrix (of size \-Dx\-N) \\
\hline
{\em \-V} & the \-V matrix (of size \-Dx\-M) \\
\hline
{\em \-C} & the \-C matrix (of size \-Nx\-K) \\
\hline
{\em beta} & the beta parameter (of size \-Kx\-M) \\
\hline
{\em \-I} & the missing data matrix \\
\hline
{\em \-N} & the number of individuals \\
\hline
{\em \-M} & the number of loci \\
\hline
{\em \-D} & the number of covariables \\
\hline
{\em \-K} & the number of latent factors \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_a88b2f546a5a50f8ffec57ef30d7171ec}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!modify\-\_\-\-C@{modify\-\_\-\-C}}
\index{modify\-\_\-\-C@{modify\-\_\-\-C}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{modify\-\_\-\-C}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf modify\-\_\-\-C} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{\-C, }
\item[{int}]{\-N, }
\item[{int}]{n\-D, }
\item[{double $\ast$}]{\-Cpp, }
\item[{int}]{d}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a88b2f546a5a50f8ffec57ef30d7171ec}
from column d of \-C (of size \-Nxn\-D), create \-Cpp (of size \-Nx2) with 1 in first column and the column d of \-C in second column


\begin{DoxyParams}{\-Parameters}
{\em \-C} & the covariable parameter (of size \-Nxn\-D) \\
\hline
{\em \-N} & the number of individuals \\
\hline
{\em n\-D} & the number of covariables \\
\hline
{\em \-Cpp} & the output parameter (of size \-Nx2) \\
\hline
{\em d} & the column of \-C to copy \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_acb4caffd3e20eef5c881bb033cf3bea3}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!update\-\_\-deviance@{update\-\_\-deviance}}
\index{update\-\_\-deviance@{update\-\_\-deviance}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{update\-\_\-deviance}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf update\-\_\-deviance} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{deviance, }
\item[{int}]{cur, }
\item[{double}]{var, }
\item[{double}]{thrd\-\_\-m}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_acb4caffd3e20eef5c881bb033cf3bea3}
update deviance parameter


\begin{DoxyParams}{\-Parameters}
{\em deviance} & the parameter to update \\
\hline
{\em cur} & the current length of the \-G\-S chain \\
\hline
{\em var} & the variance \\
\hline
{\em thrd\-\_\-m} & the current mean \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_a8f98fecf4137be7dd3d970b52195aad1}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!update\-\_\-mean@{update\-\_\-mean}}
\index{update\-\_\-mean@{update\-\_\-mean}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{update\-\_\-mean}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf update\-\_\-mean} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{mean, }
\item[{int}]{n, }
\item[{int}]{cur}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a8f98fecf4137be7dd3d970b52195aad1}
update mean parameter


\begin{DoxyParams}{\-Parameters}
{\em mean} & the parameter to update (of size n) \\
\hline
{\em beta} & the beta parameter to update the mean (of size n) \\
\hline
{\em n} & the length of mean and beta \\
\hline
{\em cur} & the current length of the \-G\-S chain \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_a6c3f14b9e0553c9897e12668d587d26c}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!update\-\_\-sum@{update\-\_\-sum}}
\index{update\-\_\-sum@{update\-\_\-sum}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{update\-\_\-sum}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf update\-\_\-sum} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{sum, }
\item[{int}]{n}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a6c3f14b9e0553c9897e12668d587d26c}
add beta to the sum, called sum


\begin{DoxyParams}{\-Parameters}
{\em beta} & the values to add (of size n) \\
\hline
{\em sum} & where to add beta (of size n) \\
\hline
{\em n} & the size of sum and beta \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_a4ae2e50700eac954ed4399d012363945}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!update\-\_\-sum2@{update\-\_\-sum2}}
\index{update\-\_\-sum2@{update\-\_\-sum2}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{update\-\_\-sum2}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf update\-\_\-sum2} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{sum2, }
\item[{int}]{n}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a4ae2e50700eac954ed4399d012363945}
add squared beta to the sum, sum


\begin{DoxyParams}{\-Parameters}
{\em beta} & the values to add (of size n) \\
\hline
{\em sum} & where to add beta (of size n) \\
\hline
{\em n} & the size of sum and beta \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_a41f76544f978b241d3c896c3a1ecdb19}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!var\-\_\-data@{var\-\_\-data}}
\index{var\-\_\-data@{var\-\_\-data}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{var\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf var\-\_\-data} (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{\-R, }
\item[{double $\ast$}]{\-U, }
\item[{double $\ast$}]{\-V, }
\item[{double $\ast$}]{\-C, }
\item[{double $\ast$}]{beta, }
\item[{int}]{\-N, }
\item[{int}]{\-M, }
\item[{int}]{\-K, }
\item[{int}]{\-D, }
\item[{double $\ast$}]{thrd\-\_\-m2, }
\item[{int}]{num\-\_\-thrd}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a41f76544f978b241d3c896c3a1ecdb19}
compute the current residual variance


\begin{DoxyParams}{\-Parameters}
{\em \-R} & the data matrix (of size \-Nx\-M) \\
\hline
{\em \-U} & the \-U matrix (of size \-Kx\-N) \\
\hline
{\em \-V} & the \-V matrix (of size \-Kx\-M) \\
\hline
{\em \-C} & the \-C matrix (of size \-Nx\-D) \\
\hline
{\em beta} & the beta parameter (of size \-Dx\-M) \\
\hline
{\em \-N} & the number of individuals \\
\hline
{\em \-M} & the number of loci \\
\hline
{\em \-D} & the number of covariables \\
\hline
{\em \-K} & the number of latent factors \\
\hline
{\em thrd\-\_\-m2} & the output value of the mean \\
\hline
{\em num\-\_\-thrd} & the number of thread used \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_a6151b34834ddf44142f6598bf837b71f}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!write\-\_\-\-D\-I\-C@{write\-\_\-\-D\-I\-C}}
\index{write\-\_\-\-D\-I\-C@{write\-\_\-\-D\-I\-C}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{write\-\_\-\-D\-I\-C}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf write\-\_\-\-D\-I\-C} (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{file\-\_\-data, }
\item[{double}]{deviance, }
\item[{double}]{\-D\-I\-C}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a6151b34834ddf44142f6598bf837b71f}
write deviance and \-D\-I\-C in file\-\_\-data file


\begin{DoxyParams}{\-Parameters}
{\em file\-\_\-data} & the file where to register \\
\hline
{\em deviance} & the deviance parameter \\
\hline
{\em \-D\-I\-C} & the \-D\-I\-C parameter \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_abbc018276b8b10c368d908911e6d0616}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!write\-\_\-zscore\-\_\-double@{write\-\_\-zscore\-\_\-double}}
\index{write\-\_\-zscore\-\_\-double@{write\-\_\-zscore\-\_\-double}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{write\-\_\-zscore\-\_\-double}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf write\-\_\-zscore\-\_\-double} (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{file\-\_\-data, }
\item[{int}]{\-M, }
\item[{double $\ast$}]{zscore}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_abbc018276b8b10c368d908911e6d0616}
compute and write absolute zscore, -\/log10(pvalue) and pvalue into file\-\_\-data with \-G separated by spaces


\begin{DoxyParams}{\-Parameters}
{\em file\-\_\-data} & the file where to write \\
\hline
{\em \-M} & the number of snps (of lines of dat) \\
\hline
{\em n\-D} & the number of columns of dat \\
\hline
{\em nd} & the column of dat to write \\
\hline
{\em dat} & the matrix to write \\
\hline
\end{DoxyParams}
\hypertarget{data__lfmm_8h_a8bbd6e5a64e1620477f22a0a694c558d}{\index{data\-\_\-lfmm.\-h@{data\-\_\-lfmm.\-h}!zscore\-\_\-calc@{zscore\-\_\-calc}}
\index{zscore\-\_\-calc@{zscore\-\_\-calc}!data_lfmm.h@{data\-\_\-lfmm.\-h}}
\subsubsection[{zscore\-\_\-calc}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf zscore\-\_\-calc} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{zscore, }
\item[{double $\ast$}]{sum, }
\item[{double $\ast$}]{sum2, }
\item[{int}]{n, }
\item[{int}]{cur}
\end{DoxyParamCaption}
)}}\label{data__lfmm_8h_a8bbd6e5a64e1620477f22a0a694c558d}
compute zscore in the dth column of beta


\begin{DoxyParams}{\-Parameters}
{\em beta} & the output matrix of zscores (of size nxn\-D) \\
\hline
{\em sum} & the sum along the \-G\-S chain along for each individual (of size 2n) \\
\hline
{\em sum2} & the squared sum along the \-G\-S chain along for each individual (of size 2n) \\
\hline
{\em n} & the number of individuals \\
\hline
{\em cur} & the length of the \-G\-S chain (without burnin) \\
\hline
{\em d} & the column where to register the zscores \\
\hline
{\em n\-D} & the number of columns of beta \\
\hline
\end{DoxyParams}
