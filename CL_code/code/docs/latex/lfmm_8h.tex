\hypertarget{lfmm_8h}{\section{src/\-L\-F\-M\-M/lfmm.h \-File \-Reference}
\label{lfmm_8h}\index{src/\-L\-F\-M\-M/lfmm.\-h@{src/\-L\-F\-M\-M/lfmm.\-h}}
}


functions to compute lfmm parameters (zscores)  


\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{lfmm_8h_a7f1207484b5a10133c9194750bf1216f}{lfmm\-\_\-emcmc} (float $\ast$dat, int $\ast$\-I, double $\ast$\-C, double $\ast$zscore, double $\ast$beta, double $\ast$\-U, double $\ast$\-V, double $\ast$alpha\-\_\-beta, double $\ast$alpha\-\_\-\-R, double $\ast$alpha\-\_\-\-U, int \-N, int \-M, int \-K, int \-D, double epsilon, int \-Niter, int burn, int missing\-\_\-data, int num\-\_\-thrd, char $\ast$output\-\_\-file, char $\ast$dev\-\_\-file)
\item 
void \hyperlink{lfmm_8h_a74f1109cc11d684d36a1db0359cd1b61}{update\-\_\-sums} (double $\ast$beta, double $\ast$\-U, double $\ast$\-V, double $\ast$sum, double $\ast$sum2, double $\ast$mean\-\_\-\-U, double $\ast$mean\-\_\-\-V, double $\ast$deviance, double thrd\-\_\-m2, int \-N, int \-M, int \-K, int \-D, double alpha\-\_\-\-R)
\item 
void \hyperlink{lfmm_8h_a9f1a172caa0d799831dc81a0c481acf3}{calc\-\_\-dp\-\_\-deviance} (float $\ast$dat, double $\ast$sum, double $\ast$mean\-\_\-\-U, double $\ast$mean\-\_\-\-V, double $\ast$\-C, double $\ast$deviance, double $\ast$dp, int size, int \-N, int \-M, int \-K, int \-D, int num\-\_\-thrd)
\item 
void \hyperlink{lfmm_8h_ab7083bd6fd214ea25f643566d3e3ef90}{allocate\-\_\-all} (double $\ast$$\ast$m\-\_\-beta, double $\ast$$\ast$inv\-\_\-cov\-\_\-beta, double $\ast$$\ast$m\-\_\-\-U, double $\ast$$\ast$inv\-\_\-cov\-\_\-\-U, double $\ast$$\ast$m\-\_\-\-V, double $\ast$$\ast$inv\-\_\-cov\-\_\-\-V, double $\ast$$\ast$mean, double $\ast$$\ast$mean\-\_\-\-U, double $\ast$$\ast$mean\-\_\-\-V, double $\ast$$\ast$sum2, double $\ast$$\ast$sum, double $\ast$$\ast$bb, double $\ast$$\ast$\-C\-Ct, int \-N, int \-M, int \-K, int \-D)
\item 
void \hyperlink{lfmm_8h_a33f0c62dde2b48781d29cb00aa85f735}{free\-\_\-all} (double $\ast$m\-\_\-beta, double $\ast$inv\-\_\-cov\-\_\-beta, double $\ast$m\-\_\-\-U, double $\ast$inv\-\_\-cov\-\_\-\-U, double $\ast$m\-\_\-\-V, double $\ast$inv\-\_\-cov\-\_\-\-V, double $\ast$mean, double $\ast$mean\-\_\-\-U, double $\ast$mean\-\_\-\-V, double $\ast$sum2, double $\ast$sum, double $\ast$bb, double $\ast$\-C\-Ct)
\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
functions to compute lfmm parameters (zscores) 

\subsection{\-Function \-Documentation}
\hypertarget{lfmm_8h_ab7083bd6fd214ea25f643566d3e3ef90}{\index{lfmm.\-h@{lfmm.\-h}!allocate\-\_\-all@{allocate\-\_\-all}}
\index{allocate\-\_\-all@{allocate\-\_\-all}!lfmm.h@{lfmm.\-h}}
\subsubsection[{allocate\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf allocate\-\_\-all} (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{m\-\_\-beta, }
\item[{double $\ast$$\ast$}]{inv\-\_\-cov\-\_\-beta, }
\item[{double $\ast$$\ast$}]{m\-\_\-\-U, }
\item[{double $\ast$$\ast$}]{inv\-\_\-cov\-\_\-\-U, }
\item[{double $\ast$$\ast$}]{m\-\_\-\-V, }
\item[{double $\ast$$\ast$}]{inv\-\_\-cov\-\_\-\-V, }
\item[{double $\ast$$\ast$}]{mean, }
\item[{double $\ast$$\ast$}]{mean\-\_\-\-U, }
\item[{double $\ast$$\ast$}]{mean\-\_\-\-V, }
\item[{double $\ast$$\ast$}]{sum2, }
\item[{double $\ast$$\ast$}]{sum, }
\item[{double $\ast$$\ast$}]{bb, }
\item[{double $\ast$$\ast$}]{\-C\-Ct, }
\item[{int}]{\-N, }
\item[{int}]{\-M, }
\item[{int}]{\-K, }
\item[{int}]{\-D}
\end{DoxyParamCaption}
)}}\label{lfmm_8h_ab7083bd6fd214ea25f643566d3e3ef90}
allocate all temporary memory


\begin{DoxyParams}{\-Parameters}
{\em m\-\_\-beta} & conditional beta mean (of size \-Dx\-M) \\
\hline
{\em inv\-\_\-cov\-\_\-beta} & inverse conditional beta covariance (of size \-Dx\-D) \\
\hline
{\em m\-\_\-\-U} & conditional \-U mean (of size \-Kx\-N) \\
\hline
{\em inv\-\_\-cov\-\_\-\-U} & inverse conditional \-U covariance (of size \-Kx\-K) \\
\hline
{\em m\-\_\-\-V} & conditional \-V mean (of size \-Kx\-M) \\
\hline
{\em inv\-\_\-cov\-\_\-\-V} & inverse conditional \-V covariance (of size \-Kx\-K) \\
\hline
{\em mean} & posterior beta mean (of size \-Dx\-M) \\
\hline
{\em mean\-\_\-\-U} & posterior \-U mean (of size \-Kx\-N) \\
\hline
{\em mean\-\_\-\-V} & posterior \-V mean (of size \-Kx\-M) \\
\hline
{\em sum2} & temporary vector ??? (of size \-Dx\-M) \\
\hline
{\em sum} & temporary vector ??? (of size \-Dx\-M) \\
\hline
{\em bb} & temporary vector ??? (of size \-D) \\
\hline
{\em \-C\-Ct} & \-C covariance matrix (of size \-Dx\-D) \\
\hline
{\em \-N} & the number of individuals \\
\hline
{\em \-M} & the number of loci \\
\hline
{\em \-K} & the number of latent factors \\
\hline
{\em \-D} & the number of covariables \\
\hline
\end{DoxyParams}
\hypertarget{lfmm_8h_a9f1a172caa0d799831dc81a0c481acf3}{\index{lfmm.\-h@{lfmm.\-h}!calc\-\_\-dp\-\_\-deviance@{calc\-\_\-dp\-\_\-deviance}}
\index{calc\-\_\-dp\-\_\-deviance@{calc\-\_\-dp\-\_\-deviance}!lfmm.h@{lfmm.\-h}}
\subsubsection[{calc\-\_\-dp\-\_\-deviance}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf calc\-\_\-dp\-\_\-deviance} (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{dat, }
\item[{double $\ast$}]{sum, }
\item[{double $\ast$}]{mean\-\_\-\-U, }
\item[{double $\ast$}]{mean\-\_\-\-V, }
\item[{double $\ast$}]{\-C, }
\item[{double $\ast$}]{deviance, }
\item[{double $\ast$}]{dp, }
\item[{int}]{size, }
\item[{int}]{\-N, }
\item[{int}]{\-M, }
\item[{int}]{\-K, }
\item[{int}]{\-D, }
\item[{int}]{num\-\_\-thrd}
\end{DoxyParamCaption}
)}}\label{lfmm_8h_a9f1a172caa0d799831dc81a0c481acf3}
update dp and deviance


\begin{DoxyParams}{\-Parameters}
{\em dat} & the data matrix (of size \-Nx\-M) \\
\hline
{\em sum} & posterior beta mean (of size \-Dx\-M) \\
\hline
{\em mean\-\_\-\-U} & posterior \-U mean (of size \-Kx\-N) \\
\hline
{\em mean\-\_\-\-V} & posterior \-V mean (of size \-Kx\-M) \\
\hline
{\em \-C} & \-The covariable matrix (of size \-Nx\-D) \\
\hline
{\em deviance} & deviance \\
\hline
{\em dp} & ??? \\
\hline
{\em size} & numbre of iterations after burnin \\
\hline
{\em \-N} & the number of individuals \\
\hline
{\em \-M} & the number of loci \\
\hline
{\em \-K} & the number of latent factors \\
\hline
{\em \-D} & the number of covariables \\
\hline
\end{DoxyParams}
\hypertarget{lfmm_8h_a33f0c62dde2b48781d29cb00aa85f735}{\index{lfmm.\-h@{lfmm.\-h}!free\-\_\-all@{free\-\_\-all}}
\index{free\-\_\-all@{free\-\_\-all}!lfmm.h@{lfmm.\-h}}
\subsubsection[{free\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf free\-\_\-all} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{m\-\_\-beta, }
\item[{double $\ast$}]{inv\-\_\-cov\-\_\-beta, }
\item[{double $\ast$}]{m\-\_\-\-U, }
\item[{double $\ast$}]{inv\-\_\-cov\-\_\-\-U, }
\item[{double $\ast$}]{m\-\_\-\-V, }
\item[{double $\ast$}]{inv\-\_\-cov\-\_\-\-V, }
\item[{double $\ast$}]{mean, }
\item[{double $\ast$}]{mean\-\_\-\-U, }
\item[{double $\ast$}]{mean\-\_\-\-V, }
\item[{double $\ast$}]{sum2, }
\item[{double $\ast$}]{sum, }
\item[{double $\ast$}]{bb, }
\item[{double $\ast$}]{\-C\-Ct}
\end{DoxyParamCaption}
)}}\label{lfmm_8h_a33f0c62dde2b48781d29cb00aa85f735}
free all temporary memory


\begin{DoxyParams}{\-Parameters}
{\em m\-\_\-beta} & conditional beta mean (of size \-Dx\-M) \\
\hline
{\em inv\-\_\-cov\-\_\-beta} & inverse conditional beta covariance (of size \-Dx\-D) \\
\hline
{\em m\-\_\-\-U} & conditional \-U mean (of size \-Kx\-N) \\
\hline
{\em inv\-\_\-cov\-\_\-\-U} & inverse conditional \-U covariance (of size \-Kx\-K) \\
\hline
{\em m\-\_\-\-V} & conditional \-V mean (of size \-Kx\-M) \\
\hline
{\em inv\-\_\-cov\-\_\-\-V} & inverse conditional \-V covariance (of size \-Kx\-K) \\
\hline
{\em mean} & posterior beta mean (of size \-Dx\-M) \\
\hline
{\em mean\-\_\-\-U} & posterior \-U mean (of size \-Kx\-N) \\
\hline
{\em mean\-\_\-\-V} & posterior \-V mean (of size \-Kx\-M) \\
\hline
{\em sum2} & temporary vector ??? (of size \-Dx\-M) \\
\hline
{\em sum} & temporary vector ??? (of size \-Dx\-M) \\
\hline
{\em bb} & temporary vector ??? (of size \-D) \\
\hline
{\em \-C\-Ct} & \-C covariance matrix (of size \-Dx\-D) \\
\hline
\end{DoxyParams}
\hypertarget{lfmm_8h_a7f1207484b5a10133c9194750bf1216f}{\index{lfmm.\-h@{lfmm.\-h}!lfmm\-\_\-emcmc@{lfmm\-\_\-emcmc}}
\index{lfmm\-\_\-emcmc@{lfmm\-\_\-emcmc}!lfmm.h@{lfmm.\-h}}
\subsubsection[{lfmm\-\_\-emcmc}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf lfmm\-\_\-emcmc} (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{dat, }
\item[{int $\ast$}]{\-I, }
\item[{double $\ast$}]{\-C, }
\item[{double $\ast$}]{zscore, }
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{\-U, }
\item[{double $\ast$}]{\-V, }
\item[{double $\ast$}]{alpha\-\_\-beta, }
\item[{double $\ast$}]{alpha\-\_\-\-R, }
\item[{double $\ast$}]{alpha\-\_\-\-U, }
\item[{int}]{\-N, }
\item[{int}]{\-M, }
\item[{int}]{\-K, }
\item[{int}]{\-D, }
\item[{double}]{epsilon, }
\item[{int}]{\-Niter, }
\item[{int}]{burn, }
\item[{int}]{missing\-\_\-data, }
\item[{int}]{num\-\_\-thrd, }
\item[{char $\ast$}]{output\-\_\-file, }
\item[{char $\ast$}]{dev\-\_\-file}
\end{DoxyParamCaption}
)}}\label{lfmm_8h_a7f1207484b5a10133c9194750bf1216f}
calculate \-L\-F\-M\-M parameters


\begin{DoxyParams}{\-Parameters}
{\em dat} & the data matrix (of size \-Nx\-M) \\
\hline
{\em \-I} & missing data matrix \\
\hline
{\em \-C} & \-The covariable matrix (of size \-Nx\-D) \\
\hline
{\em zscore} & the output zscore matrix \\
\hline
{\em beta} & the beta matrix (of size \-Dx\-M) \\
\hline
{\em \-U} & the \-U matrix (of size \-Kx\-N) \\
\hline
{\em \-V} & the \-V matrix (of size \-Kx\-M) \\
\hline
{\em alpha\-\_\-beta} & the vector of hyperparameters for beta (of size \-D) \\
\hline
{\em alpha\-\_\-\-R} & the inverse of the residual variance \\
\hline
{\em alpha\-\_\-\-U} & the hyperparameter for \-U \\
\hline
{\em \-N} & the number of individuals \\
\hline
{\em \-M} & the number of loci \\
\hline
{\em \-K} & the number of latent factors \\
\hline
{\em \-D} & the number of covariables \\
\hline
{\em epsilon} & epsilon constant \\
\hline
{\em \-Niter} & the number of iterations \\
\hline
{\em burn} & the number of burnin \\
\hline
{\em missing\-\_\-data} & true if missing data \\
\hline
{\em num\-\_\-thrd} & the number of processes used \\
\hline
{\em output\-\_\-file} & the name of the output zscore file \\
\hline
{\em dev\-\_\-file} & the name of the output \-D\-I\-C file \\
\hline
\end{DoxyParams}
\hypertarget{lfmm_8h_a74f1109cc11d684d36a1db0359cd1b61}{\index{lfmm.\-h@{lfmm.\-h}!update\-\_\-sums@{update\-\_\-sums}}
\index{update\-\_\-sums@{update\-\_\-sums}!lfmm.h@{lfmm.\-h}}
\subsubsection[{update\-\_\-sums}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf update\-\_\-sums} (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{beta, }
\item[{double $\ast$}]{\-U, }
\item[{double $\ast$}]{\-V, }
\item[{double $\ast$}]{sum, }
\item[{double $\ast$}]{sum2, }
\item[{double $\ast$}]{mean\-\_\-\-U, }
\item[{double $\ast$}]{mean\-\_\-\-V, }
\item[{double $\ast$}]{deviance, }
\item[{double}]{thrd\-\_\-m2, }
\item[{int}]{\-N, }
\item[{int}]{\-M, }
\item[{int}]{\-K, }
\item[{int}]{\-D, }
\item[{double}]{alpha\-\_\-\-R}
\end{DoxyParamCaption}
)}}\label{lfmm_8h_a74f1109cc11d684d36a1db0359cd1b61}
update different sums


\begin{DoxyParams}{\-Parameters}
{\em beta} & posterior beta mean (of size \-Dx\-M) \\
\hline
{\em \-U} & posterior \-U mean (of size \-Kx\-N) \\
\hline
{\em \-V} & posterior \-V mean (of size \-Kx\-M) \\
\hline
{\em sum2} & temporary vector (of size \-Dx\-M) \\
\hline
{\em sum} & temporary vector (of size \-Dx\-M) \\
\hline
{\em mean\-\_\-\-U} & posterior \-U mean (of size \-Kx\-N) \\
\hline
{\em mean\-\_\-\-V} & posterior \-V mean (of size \-Kx\-M) \\
\hline
{\em deviance} & deviance \\
\hline
{\em thrd\-\_\-m2} & ?? \\
\hline
{\em \-N} & the number of individuals \\
\hline
{\em \-M} & the number of loci \\
\hline
{\em \-K} & the number of latent factors \\
\hline
{\em \-D} & the number of covariables \\
\hline
{\em alpha\-\_\-\-R} & the inverse of the residual variance \\
\hline
\end{DoxyParams}
